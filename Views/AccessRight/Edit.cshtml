@model UserEditModel
@{
	UserModel User = Model.User;
	ViewBag.Title = User.surUID == 0 ? string.Format(Resources.Resource.AddFormat, Resources.Resource.SalesPerson) : string.Format(Resources.Resource.EditFormat, Resources.Resource.SalesPerson);
	bool edit = User.surUID > 0;
	string userCode = edit ? User.UserCode : Model.MaxSalesCode;
	bool approvalmode = ConfigurationManager.AppSettings["ApprovalMode"] == "1";
}

@using (Html.BeginForm("Edit", "AccessRight", FormMethod.Post, new { @id = "arform" }))
{
	@Html.AntiForgeryToken()

	<h3 class="mb-4">@ViewBag.Title</h3>

	<div class="form-horizontal">

		<div class="form-group">
			<label for="UserCode">@Resources.Resource.UserCode</label>
			<input class="form-control text-box single-line" id="UserCode" name="UserCode" readonly="readonly" type="text" value="@userCode">
		</div>

		<div class="form-group required">
			<label for="UserName">@Resources.Resource.UserName</label>
			<input type="text" class="form-control" id="UserName" name="UserName" value="@(edit?User.UserName:"")" />
		</div>

		<div class="form-group">
			<label for="Email">@Resources.Resource.Email</label>
			<input type="email" class="form-control" id="Email" name="Email" value="@(edit?User.Email:"")" />
		</div>

		<div id="roleblk" class="form-group required">
			<label>@Resources.Resource.Position4POS</label>
			<select id="drpRoles" class="form-control" multiple>
				@foreach (var item in Model.RoleList)
				{
					var selected = edit && (User.RoleIds.Contains(int.Parse(item.Value))) ? "selected" : item.Text.ToLower() == "staff" ? "selected" : "";
					<option value="@item.Value" @selected>@item.Text</option>
				}
			</select>
		</div>

		@if (approvalmode)
		{
			<div class="form-group">
				<label for="drpPosAdmin">@Resources.Resource.FrmWhomReceiveNotificationEmail</label>
				<select class="form-control" id="drpPosAdmin">
					<option value="">-- @Resources.Resource.Select --</option>
					@foreach (var a in Model.BossList)
					{
						var selected = User.ManagerId == a.surUID ? "selected" : "";
						<option value="@a.surUID" @selected>@a.UserName</option>
					}
				</select>

			</div>
		}


		@if (edit)
		{
			<div id="chkpassblk" class="form-check">
				<input class="form-check-input" type="checkbox" value="" id="chkpass">
				<label class="form-check-label" for="chkpass">
					@Resources.Resource.ChangePass
				</label>
			</div>
		}


		<div id="passblk" class="hide">
			<div class="form-group">
				<label for="Password">@Resources.Resource.Password</label>
				<input type="password" class="form-control" id="Password" name="Password" value="@(edit?User.Password:"")" />
			</div>

			<div class="form-group">
				<label for="ConfirmPassword">@Resources.Resource.ConfirmPassword</label>
				<input type="password" class="form-control" id="ConfirmPassword" name="ConfirmPassword" value="" />
			</div>
		</div>
	</div>

	var _checked = edit ? User.surIsActive ? "checked" : "" : "checked";
	<div class="form-check form-check-inline">
		<input class="form-check-input" type="checkbox" id="surIsActive" @_checked>
		<label class="form-check-label" for="surIsActive">@Resources.Resource.Active</label>
	</div>

	<div class="form-group my-4">
		<button id="btnSave" type="button" class="btn btn-success">@Resources.Resource.Save</button>
		<input type="hidden" id="surUID" value="@User.surUID" />
		<input type="hidden" id="checkpass" value="@(edit?User.checkpass:false)" />
		<input type="hidden" id="currpass" name="Password" value="@(edit?User.Password:"")" />
	</div>
}

<div>
	@Html.ActionLink(Resources.Resource.BackToList, "Index", "AccessRight")
</div>

@Html.Partial("_WaitingModal")
<div id="infoblk" data-addnewlyaddedtxt="@Resources.Resource.AddNewlyAddedEmployeeToABSS" data-debug="@ConfigurationManager.AppSettings["Debug"]"></div>
<script src="~/Scripts/ts/js/admin/accessrights/edit.js?v=@CommonHelper.GetVersionRandomNo()"></script>